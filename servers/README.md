# üß∞ Scripts for Server

<details>
<summary> üöÄ VPN Installer for Ubuntu (PPTP & L2TP/IPSec)</summary>

–°–∫—Ä–∏–ø—Ç –¥–ª—è –±—ã—Å—Ç—Ä–æ–π —É—Å—Ç–∞–Ω–æ–≤–∫–∏ VPN-—Å–µ—Ä–≤–µ—Ä–∞ –Ω–∞ Ubuntu. –ü–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç:

- ‚úÖ PPTP VPN ‚Äî –ø—Ä–æ—Å—Ç–æ–π, –Ω–æ –Ω–µ–±–µ–∑–æ–ø–∞—Å–Ω—ã–π (–¥–ª—è —Å—Ç–∞—Ä—ã—Ö –∫–ª–∏–µ–Ω—Ç–æ–≤)
- ‚úÖ L2TP/IPSec VPN —Å Pre-Shared Key (PSK) ‚Äî –±–æ–ª–µ–µ –Ω–∞–¥—ë–∂–Ω—ã–π –≤–∞—Ä–∏–∞–Ω—Ç

---

## üì¶ –ß—Ç–æ –¥–µ–ª–∞–µ—Ç —Å–∫—Ä–∏–ø—Ç

- –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç –Ω—É–∂–Ω—ã–µ –ø–∞–∫–µ—Ç—ã (`pptpd`, `xl2tpd`, `strongswan`, `ppp`, `iptables-persistent`)
- –ù–∞—Å—Ç—Ä–∞–∏–≤–∞–µ—Ç VPN-–∫–æ–Ω—Ñ–∏–≥–∏
- –î–æ–±–∞–≤–ª—è–µ—Ç –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è (–ª–æ–≥–∏–Ω/–ø–∞—Ä–æ–ª—å)
- (–¥–ª—è L2TP) –î–æ–±–∞–≤–ª—è–µ—Ç PSK (–ø—Ä–µ–¥–≤–∞—Ä–∏—Ç–µ–ª—å–Ω—ã–π –∫–ª—é—á)
- –ù–∞—Å—Ç—Ä–∞–∏–≤–∞–µ—Ç IP Forwarding –∏ NAT (`iptables`)
- –°–æ—Ö—Ä–∞–Ω—è–µ—Ç –ø—Ä–∞–≤–∏–ª–∞ —á–µ—Ä–µ–∑ `netfilter-persistent`
- –û–ø—Ä–µ–¥–µ–ª—è–µ—Ç –≤–Ω–µ—à–Ω–∏–π IP —Å–µ—Ä–≤–µ—Ä–∞
- –ü–æ–∫–∞–∑—ã–≤–∞–µ—Ç –∏—Ç–æ–≥–æ–≤—ã–µ –¥–∞–Ω–Ω—ã–µ –¥–ª—è –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è

---

## ‚öôÔ∏è –¢—Ä–µ–±–æ–≤–∞–Ω–∏—è

- Ubuntu
- –ü—Ä–∞–≤–∞ `root` –∏–ª–∏ –∑–∞–ø—É—Å–∫ —á–µ—Ä–µ–∑ `sudo`
- –í–Ω–µ—à–Ω–∏–π (–ø—É–±–ª–∏—á–Ω—ã–π) IP-–∞–¥—Ä–µ—Å

---

## üì• –£—Å—Ç–∞–Ω–æ–≤–∫–∞

1. –°–∫–∞—á–∞–π –∏ –¥–∞–π –ø—Ä–∞–≤–∞ –Ω–∞ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–µ:

```bash
wget https://raw.githubusercontent.com/salimyar98/scripts/main/servers/vpn_installer.sh
chmod +x vpn_installer.sh
sudo ./vpn_installer.sh
```

---

## üõ†Ô∏è –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ

### –°–∫—Ä–∏–ø—Ç –ø—Ä–∏ –∑–∞–ø—É—Å–∫–µ –ø—Ä–µ–¥–ª–æ–∂–∏—Ç:
- –í—ã–±—Ä–∞—Ç—å —Ç–∏–ø VPN:
  - 1 ‚Äî PPTP
  - 2 ‚Äî L2TP/IPSec —Å PSK
- –í–≤–µ—Å—Ç–∏ –ª–æ–≥–∏–Ω
- –í–≤–µ—Å—Ç–∏ –ø–∞—Ä–æ–ª—å
- (–¥–ª—è L2TP) –í–≤–µ—Å—Ç–∏ PSK (–∫–ª—é—á)

### –ü–æ—Å–ª–µ —É—Å—Ç–∞–Ω–æ–≤–∫–∏ –≤—ã–≤–µ–¥–µ—Ç:
- –ü—É–±–ª–∏—á–Ω—ã–π IP —Å–µ—Ä–≤–µ—Ä–∞
- –õ–æ–≥–∏–Ω
- –ü–∞—Ä–æ–ª—å
- PSK (–µ—Å–ª–∏ –≤—ã–±—Ä–∞–Ω L2TP)

---

## üîì –ü–æ—Ä—Ç—ã –∏ NAT

### –°–∫—Ä–∏–ø—Ç –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏:
- –í–∫–ª—é—á–∞–µ—Ç net.ipv4.ip_forward
- –î–æ–±–∞–≤–ª—è–µ—Ç –ø—Ä–∞–≤–∏–ª–∞ iptables:
  - NAT (MASQUERADE)
  - FORWARD –¥–ª—è –∫–ª–∏–µ–Ω—Ç—Å–∫–æ–π —Å–µ—Ç–∏
- –°–æ—Ö—Ä–∞–Ω—è–µ—Ç –ø—Ä–∞–≤–∏–ª–∞ (netfilter-persistent)
- UFW –Ω–µ —Ç—Ä–æ–≥–∞–µ—Ç ‚Äî –µ—Å–ª–∏ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è, –ø–æ—Ä—Ç—ã –æ—Ç–∫—Ä–æ–π—Ç–µ –≤—Ä—É—á–Ω—É—é.

### –ò—Å–ø–æ–ª—å–∑—É–µ–º—ã–µ –ø–æ—Ä—Ç—ã:
| –ü—Ä–æ—Ç–æ–∫–æ–ª | –ü–æ—Ä—Ç  |     –ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ      |
|:--------:|:-----:|:-------------------:|
|   TCP    | 1723  |        PPTP         |
|   GRE    |   ‚Äî   | PPTP (–ø—Ä–æ—Ç–æ–∫–æ–ª 47)  |
|   UDP    |  500  |     IPsec (IKE)     |
|   UDP    | 4500  | IPsec NAT Traversal |
|   UDP    | 1701  |        L2TP         |

---

## ‚ùó –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å
- ‚ö†Ô∏è PPTP ‚Äî —É—Å—Ç–∞—Ä–µ–ª –∏ —É—è–∑–≤–∏–º. –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å —Ç–æ–ª—å–∫–æ –≤ –∑–∞–∫—Ä—ã—Ç—ã—Ö —Å–µ—Ç—è—Ö –∏–ª–∏ –¥–ª—è —Ç–µ—Å—Ç–∞.
- ‚úÖ L2TP/IPSec –±–µ–∑–æ–ø–∞—Å–Ω–µ–µ, –Ω–æ WireGuard/OpenVPN ‚Äî –µ—â—ë –Ω–∞–¥—ë–∂–Ω–µ–µ.
- üîê –°–∫—Ä–∏–ø—Ç –Ω–µ –≤–∫–ª—é—á–∞–µ—Ç –±—Ä–∞–Ω–¥–º–∞—É—ç—Ä ‚Äî –∑–∞—â–∏—â–∞–π —Å–µ—Ä–≤–µ—Ä —Å–∞–º–æ—Å—Ç–æ—è—Ç–µ–ª—å–Ω–æ!

---

## üß™ –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è

### –ü–æ—Å–ª–µ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è –∫–ª–∏–µ–Ω—Ç–∞ (–Ω–∞–ø—Ä–∏–º–µ—Ä, —Ä–æ—É—Ç–µ—Ä–∞):

```bash
# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –∞–∫—Ç–∏–≤–Ω—ã–µ ppp-—Å–µ—Å—Å–∏–∏
ps aux | grep pppd
ip a show ppp+

# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –ª–æ–≥–∏
journalctl -u pptpd -f
journalctl -u xl2tpd -f
journalctl -u strongswan-starter -f
```
---

## üßπ –£–¥–∞–ª–µ–Ω–∏–µ (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)

```bash
systemctl disable --now pptpd
systemctl disable --now strongswan-starter
systemctl disable --now xl2tpd
```
–ò –ø—Ä–∏ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç–∏ ‚Äî –æ—á–∏—Å—Ç–∏—Ç—å –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏ –≤—Ä—É—á–Ω—É—é.
